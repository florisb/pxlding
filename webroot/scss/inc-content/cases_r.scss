
/*
 * Cases grid
 */

$toTwoColumns : 850px;
$toOneColumn  : 520px;


@media (min-width: $toTwoColumns) {

	$columns      : 3;
	$marginColumn : $margin-def * 4;

	section.cases {

		// widths: 3rd vs wider
		.case {
			width: col-width-abs($columns, $marginColumn);
			margin-right: $marginColumn;

			&.wide {
				// use size-helper to force right height for wide cases
				// this is basically a hack to prevent problems with fixed px margins and
				// the impossibility within the frame of reference to calculate the correct margins:
				//
				// 		2/3s of the width, but taking into account 80px outside and 80px inside the wide case..
				//
				// so this just falls back to letting a square responsive-fixed shape determine the
				// height of the image-container
				.size-helper {
					display: block;
					width: calc(50% - #{$marginColumn / 2});

					&::before {
						@include pseudo-basic;
						width: 100%;
						height: 0;
						padding-top: 100%;
					}
				}
				.image {
					position: absolute;
					width: 100%;
					height: 100%;
					padding-top: 0;
				}

				width: calc(#{100% / $columns * 2} - #{$marginColumn - $marginColumn * ($columns - 1) / $columns});
			}
		}
		.case {

			// first of row
			&:nth-child(1),
			 &:nth-child(4),
			 &:nth-child(6),
			 &:nth-child(9) {
					clear: left;
			}

			// last of row
			&:nth-child(3),
			 &:nth-child(5),
			 &:nth-child(8),
			 &:nth-child(10) {
					margin-right: 0;
			}
		}
	}
}

@media #{$media-tablet} {

	$columns      : 3;
	$marginColumn : $margin-def * 2;

	section.cases {
		margin-bottom: $margin-def * 2;

		// widths: 3rd vs wider
		.case {
			width: col-width-abs($columns, $marginColumn);
			margin-right: $marginColumn;
			margin-bottom: $marginColumn;

			&.wide {
				width: 100%;
				.size-helper {
					width: calc(50% - #{$marginColumn / 2});
				}

				width: calc(#{100% / $columns * 2} - #{$marginColumn - $marginColumn * ($columns - 1) / $columns});
			}
		}
	}
}

@media (min-width: $toOneColumn) and (max-width: $toTwoColumns) {

	$columns      : 2;
	$marginColumn : $margin-def * 2;

	section.cases {

		// widths: 3rd vs wider
		.case {
			width: col-width-abs($columns, $marginColumn);
			margin-right: $marginColumn;
			margin-bottom: $marginColumn;

			&.wide {
				width: 100%;

				.size-helper {
					display: block;
					width: 100%;

					&::before {
						@include pseudo-basic;
						width: 100%;
						height: 0;
						// no idea why this is 1% off, but this works
						padding-top: 50% - 0.5;
					}
				}
				.image {
					position: absolute;
					width: 100%;
					height: 100%;
					padding-top: 0;
				}
			}
		}


		.case {

			// first of row
			&:nth-child(1),
			 &:nth-child(3),
			 &:nth-child(4),
			 &:nth-child(6),
			 &:nth-child(8),
			 &:nth-child(10) {
					clear: left;
			}

			// last of row
			&:nth-child(2),
			 &:nth-child(4),
			 &:nth-child(5),
			 &:nth-child(7),
			 &:nth-child(9),
			  &:nth-child(10) {
					margin-right: 0;
			}

			// quirky float order fix
			&:nth-child(5) {
				float: right;
				// funky hack to get right floated #5 next to #3 (so above #4)
				margin-top: calc(-100% - 217px);
			}
			&:nth-child(6) {
				clear: both;
			}

		}
	}
}

@media #{$media-phone} {

	$columns      : 2;
	$marginColumn : $margin-def;

	section.cases {
		margin-bottom: $margin-def * 3;

		.case {
			width: col-width-abs($columns, $marginColumn);
			margin-right: $marginColumn;
			margin-bottom: $marginColumn;

			&.wide {
				width: 100%;

				.size-helper {
					display: block;
					width: calc(100% - #{$marginColumn / 2});
				}
			}
		}

	}
}
@media (min-width: $toOneColumn) and (max-width: $width-phone) {

	section.cases {

		.case {
			// quirky float order fix
			&:nth-child(5) {
				// funky hack to get right floated #5 next to #3 (so above #4)
				margin-top: calc(-100% - 183px);
			}
		}
	}
}


@media (max-width: $toOneColumn) {

	$marginColumn : $margin-def;

	section.cases {

		.case {
			width: 100%;
			margin-bottom: $marginColumn * 2;
			margin-right: 0;

			&.wide {
				width: 100%;

				.size-helper {
					display: none;
				}
				.image {
					position: relative;
					width: 100%;
					height: 0;
					padding-top: 50%;
				}
			}
		}
	}
}

